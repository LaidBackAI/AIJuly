# 08-1 | 합성곱 신경망의 구성 요소

```python
keras.layers.Conv2D(10, kernel_size=(3,3), activation='relu',
                    padding='same', strides=1)
```

합성곱 신경망을 구성하는 핵심 개념을 살펴보았다. 여기에는 합성곱, 필터, 패딩, 스트라이드, 풀링 등이 포함된다. 합성곱 신경망은 직관적으로 이해하기 쉽지 않지만 이미지 처리에서 뛰어난 성능을 발휘할 수 있도록 발전된 결과물이다. 우리 뇌 속에 있는 신경 조직을 흉내내기 위해 만든 것이 아니다.

합성곱 층과 풀링 층은 거의 항상 함께 사용된다. 합성곱 층에서 입력의 크기를 유지하며 각 필터가 추출한 특성 맵을 출력하면 풀링 층에서 특성 맵의 가로세로를 줄인다. 일반적으로 최대 풀링을 즐겨 사용하며 특성 맵을 절반으로 줄인다. 마지막에는 특성 맵을 1차원 배열로 펼쳐서 1개 이상의 밀집층에 통과시켜 클래스에 대한 확률을 만든다.

합성곱 신경망에는 새로운 개념이 많이 등장하기 때문에 코드보다는 구조를 이해하는 데 집중했다.

- **합성곱**은 밀집층과 비슷하게 입력과 가중치를 곱하고 절편을 더하는 선형 계산이다. 하지만 밀집층과 달리 각 합성곱은 입력 전체가 아니라 일부만 사용하여 선형 계산을 수행한다.
- 합성곱 층의 **필터**는 밀집층의 뉴런에 해당한다. 필터의 가중치와 절편을 종종 커널이라고 부른다. 자주 사용되는 커널의 크기는 (3, 3) 또는 (5, 5)이다. 커널의 깊이는 입력의 깊이와 같다.
- **특성 맵**은 합성곱 층이나 풀링 층의 출력 배열을 의미한다. 필터 하나가 하나의 특성 맵을 만든다. 합성곱 층에서 5개의 필터를 적용하면 5개의 특성 맵이 만들어진다.
- **패딩**은 합성곱 층의 입력 주위에 추가한 0으로 채워진 픽셀이다. 패딩을 사용하지 않는 것을 밸리드 패딩이라고 한다. 합성곱 층의 출력 크기를 입력과 동일하게 만들기 위해 입력에 패딩을 추가하는 것을 세임 패딩이라고 한다.
- **스트라이드**는 합성곱 층에서 필터가 입력 위를 이동하는 크기이다. 일반적으로 스트라이드는 1픽셀을 사용한다.
- **풀링**은 가중치가 없고 특성 맵의 가로세로 크기를 줄이는 역할을 수행한다. 대표적으로 최대 풀링과 평균 풀링이 있으며 (2, 2) 풀링으로 입력을 절반으로 줄인다.